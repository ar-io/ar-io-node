---

version: '3.0'
services:
  envoy:
    build:
        context: envoy/
        dockerfile: Dockerfile.envoy
    ports:
      - '1984:1984'
      - '9901:9901'
    environment:
      - 'ARWEAVE_NODES=node-ny-247rack-1.ar.io:1984,node-ny-247rack-2.ar.io:1984,chain-ny-247rack-1.ar.io:1984'

  ario:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - 3000:3000
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3000/healthcheck"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    environment:
      ENV: development