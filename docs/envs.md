# ENVs

This document describes the environment variables that can be used to configure the `ar.io` node.

| ENV_NAME                                         | TYPE                 | DEFAULT_VALUE                                 | DESCRIPTION                                                                                                                                                          |
| ------------------------------------------------ | -------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| START_HEIGHT                                     | Number or "Infinity" | 0                                             | Starting block height for node synchronization (0 = start from the beginning)                                                                                        |
| STOP_HEIGHT                                      | Number or "Infinity" | "Infinity"                                    | Stop block height for node synchronization (Infinity = keep syncing until stopped)                                                                                   |
| TRUSTED_NODE_URL                                 | String               | "https://arweave.net"                         | Arweave node to use for fetching data                                                                                                                                |
| TRUSTED_NODE_HOST                                | String               | "arweave.net"                                 | Hostname for the trusted Arweave node used by Envoy proxy                                                                                                            |
| TRUSTED_NODE_PORT                                | Number               | 443                                           | Port for the trusted Arweave node used by Envoy proxy                                                                                                                |
| TRUSTED_GATEWAY_URL                              | String               | "https://arweave.net"                         | Arweave node to use for proxying requests                                                                                                                            |
| TRUSTED_GATEWAYS_URLS                            | String               | TRUSTED_GATEWAY_URL                           | A JSON map of gateways and priority                                                                                                                                  |
| TRUSTED_GATEWAYS_REQUEST_TIMEOUT_MS              | String               | "10000"                                       | Request timeout in milliseconds for trusted gateways                                                                                                                 |
| TRUSTED_GATEWAYS_BLOCKED_ORIGINS                 | String               | ""                                            | Comma-separated list of X-AR-IO-Origin header values to block when forwarding to trusted gateways (prevents loops and blocks unwanted sources)                   |
| TRUSTED_GATEWAYS_BLOCKED_IPS_AND_CIDRS           | String               | ""                                            | Comma-separated list of IPs and CIDR ranges to block when forwarding to trusted gateways (prevents forwarding requests from specific client IPs)                |
| TRUSTED_ARNS_GATEWAY_URL                         | String               | "https://__NAME__.ar-io.net"                  | ArNS gateway                                                                                                                                                         |
| TURBO_ENDPOINT                                   | String               | "https://turbo.arweave.dev"                   | Turbo endpoint URL for root transaction ID lookups                                                                                                                   |
| TURBO_REQUEST_TIMEOUT_MS                         | Number               | 10000                                         | Request timeout in milliseconds for Turbo requests                                                                                                                   |
| TURBO_REQUEST_RETRY_COUNT                        | Number               | 3                                             | Number of retries for Turbo requests                                                                                                                                 |
| BUNDLER_URLS                                     | String               | "https://turbo.ardrive.io/"                   | Comma-separated list of bundler service URLs advertised in /ar-io/info endpoint for client service discovery                                                         |
| GATEWAYS_ROOT_TX_URLS                            | JSON Object          | {"https://turbo-gateway.com": 1}              | JSON map of AR.IO gateway URLs and priority weights for root transaction offset discovery via HEAD requests. Lower numbers = higher priority                         |
| GATEWAYS_ROOT_TX_REQUEST_TIMEOUT_MS              | Number               | 10000                                         | Request timeout in milliseconds for gateway HEAD requests                                                                                                            |
| GATEWAYS_ROOT_TX_RATE_LIMIT_BURST_SIZE           | Number               | 5                                             | Rate limit burst size for gateway HEAD requests                                                                                                                      |
| GATEWAYS_ROOT_TX_RATE_LIMIT_TOKENS_PER_INTERVAL  | Number               | 6                                             | Rate limit tokens per interval for gateway HEAD requests (6 per minute = 1 per 10 seconds)                                                                          |
| GATEWAYS_ROOT_TX_RATE_LIMIT_INTERVAL             | String               | "minute"                                      | Rate limit interval for gateway HEAD requests (second/minute/hour/day)                                                                                               |
| ROOT_TX_LOOKUP_ORDER                             | String               | "db,gateways,cdb,graphql"                     | Comma-separated list of root TX lookup sources in order of priority. Options: 'db' (local database), 'cdb' (CDB64 file index), 'gateways' (AR.IO gateways), 'turbo' (Turbo API), 'graphql' (GraphQL). CDB64 enabled by default since Release 67 |
| CDB64_ROOT_TX_INDEX_WATCH                        | Boolean              | true                                          | Enable runtime file watching for local CDB64 directories. When true, .cdb files added to or removed from watched directories are automatically loaded/unloaded without restart |
| CDB64_ROOT_TX_INDEX_SOURCES                      | String               | shipped manifest (see note)                   | Comma-separated list of CDB64 index sources. Supports: local paths, directories, Arweave TX IDs (43-char base64url), bundle data items (txId:offset:size), HTTP URLs, and partitioned manifests. Default ships with ~964M records covering non-AO, non-Redstone data items up to block 1,820,000 |
| CDB64_REMOTE_RETRIEVAL_ORDER                     | String               | "gateways,chunks"                             | Comma-separated list of data sources for fetching remote CDB64 files. Options: 'gateways' (trusted gateways), 'chunks' (L1 chunk reconstruction), 'tx-data' (Arweave node /tx/:id/data) |
| CDB64_REMOTE_CACHE_MAX_REGIONS                   | Number               | 100                                           | Maximum number of byte-range regions to cache per remote CDB64 source |
| CDB64_REMOTE_CACHE_TTL_MS                        | Number               | 300000                                        | TTL in milliseconds for cached CDB64 byte-range regions (5 minutes) |
| CDB64_REMOTE_REQUEST_TIMEOUT_MS                  | Number               | 30000                                         | Request timeout in milliseconds for remote CDB64 source requests (30 seconds) |
| CDB64_REMOTE_MAX_CONCURRENT_REQUESTS             | Number               | 4                                             | Maximum concurrent HTTP requests across all remote CDB64 sources. Limits request pile-up when reading CDB files from HTTP/S3 endpoints |
| CDB64_REMOTE_SEMAPHORE_TIMEOUT_MS                | Number               | 5000                                          | Maximum time in milliseconds to wait for a request slot before failing. Prevents indefinite blocking when concurrent request limit is reached |
| ROOT_TX_CACHE_MAX_SIZE                           | Number               | 100000                                        | Maximum size of the root transaction ID cache                                                                                                                        |
| ROOT_TX_CACHE_TTL_MS                             | Number               | 300000                                        | TTL in milliseconds for root transaction ID cache entries (5 minutes)                                                                                                |
| ROOT_TX_INDEX_CIRCUIT_BREAKER_TIMEOUT_MS         | Number               | 30000                                         | Circuit breaker timeout in milliseconds for root transaction index requests                                                                                          |
| ROOT_TX_INDEX_CIRCUIT_BREAKER_FAILURE_THRESHOLD  | Number               | 50                                            | Circuit breaker failure threshold percentage for root transaction index requests                                                                                     |
| ROOT_TX_INDEX_CIRCUIT_BREAKER_SUCCESS_THRESHOLD  | Number               | 2                                             | Number of successful requests needed to close circuit breaker for root transaction index                                                                             |
| WEIGHTED_PEERS_TEMPERATURE_DELTA                 | Number               | 0.1                                           | Any positive number above 0, best to keep 1 or less. Used to determine the sensivity of which the probability of failing or succeeding peers decreases or increases. |
| INSTANCE_ID                                      | String               | ""                                            | Adds an "INSTANCE_ID" field to output logs                                                                                                                           |
| LOG_FORMAT                                       | String               | "simple"                                      | Sets the format of output logs, accepts "simple" and "json"                                                                                                          |
| SKIP_CACHE                                       | Boolean              | false                                         | If true, skips the local cache and always fetches headers from the node                                                                                              |
| SKIP_DATA_CACHE                                  | Boolean              | false                                         | If true, skips the data cache (read-through data cache) and always fetches data from upstream sources                                                               |
| PORT                                             | Number               | 4000                                          | ar.io node exposed port number                                                                                                                                       |
| SIMULATED_REQUEST_FAILURE_RATE                   | Number               | 0                                             | Number from 0 to 1, representing the probability of a request failing                                                                                                |
| AR_IO_WALLET                                     | String               | ""                                            | Arweave wallet address used for staking and rewards                                                                                                                  |
| ADMIN_API_KEY                                    | String               | Generated                                     | API key used for admin API requests (if not set, it's generated and logged into the console)                                                                         |
| ADMIN_API_KEY_FILE                               | String               | Generated                                     | Alternative way to set the API key used for admin API requests via filepath, it takes precedene over ADMIN_API_KEY if defined                                        |
| BACKFILL_BUNDLE_RECORDS                          | Boolean              | false                                         | If true, ar.io node will start indexing missing bundles                                                                                                              |
| FILTER_CHANGE_REPROCESS                          | Boolean              | false                                         | If true, all indexed bundles will be reprocessed with the new filters (you can use this when you change the filters)                                                 |
| ON_DEMAND_RETRIEVAL_ORDER                        | String               | trusted-gateways,ar-io-network,chunks-offset-aware,tx-data | Data source retrieval order for on-demand data requests. Note: 'chunks-data-item' is deprecated, use 'chunks-offset-aware' instead                                   |
| BACKGROUND_RETRIEVAL_ORDER                       | String               | chunks                                         | Data source retrieval order for background data requests (i.e., unbundling)                                                                                          |
| ANS104_UNBUNDLE_FILTER                           | String               | {"never": true}                               | Only bundles compliant with this filter will be unbundled                                                                                                            |
| ANS104_INDEX_FILTER                              | String               | {"never": true}                               | Only bundles compliant with this filter will be indexed                                                                                                              |
| ANS104_DOWNLOAD_WORKERS                          | String               | 5                                             | Sets the number of ANS-104 bundles to attempt to download in parallel                                                                                                |
| ANS104_UNBUNDLE_WORKERS                          | Number               | 0, or 1 if filters are set                    | Sets the number of workers used to handle unbundling                                                                                                                 |
| DATA_ITEM_FLUSH_COUNT_THRESHOLD                  | Number               | 1000                                          | Sets the number of new data items indexed before flushing to to stable data items                                                                                    |
| MAX_FLUSH_INTERVAL_SECONDS                       | Number               | 600                                           | Sets the maximum time interval in seconds before flushing to stable data items                                                                                       |
| WRITE_ANS104_DATA_ITEM_DB_SIGNATURES             | Boolean              | false                                         | If true, the data item signatures will be written to the database.                                                                                                   |
| WRITE_TRANSACTION_DB_SIGNATURES                  | Boolean              | true                                          | If true, the transactions signatures will be written to the database.                                                                                                |
| ENABLE_DATA_DB_WAL_CLEANUP                       | Boolean              | false                                         | If true, the data database WAL cleanup worker will be enabled                                                                                                        |
| ENABLE_BACKGROUND_DATA_VERIFICATION              | Boolean              | false                                         | If true, unverified data will be verified in background                                                                                                              |
| ENABLE_DATA_ITEM_ROOT_TX_SEARCH                  | Boolean              | true                                          | If true, enables searching external APIs (GraphQL/Turbo) to find root transaction when local attributes are incomplete for offset-aware data sources               |
| ENABLE_PASSTHROUGH_WITHOUT_OFFSETS               | Boolean              | true                                          | If true, allows data retrieval without offset information in offset-aware data sources (falls back to less efficient methods)                                       |
| MAX_DATA_ITEM_QUEUE_SIZE                         | Number               | 100000                                        | Sets the maximum number of data items to queue for indexing before skipping indexing new data items                                                                  |
| ARNS_ROOT_HOST                                   | String               | undefined                                     | Domain name for ArNS host                                                                                                                                            |
| SANDBOX_PROTOCOL                                 | String               | undefined                                     | Protocol (http/https) for ArNS sandbox redirects and x402 payment resource URLs. Set to 'https' when behind a reverse proxy/CDN. Used when ARNS_ROOT_HOST is set.    |
| START_WRITERS                                    | Boolean              | true                                          | If true, start indexing blocks, tx, ANS104 bundles                                                                                                                   |
| RUN_OBSERVER                                     | Boolean              | true                                          | If true, runs the Observer alongside the gateway to generate Network compliance reports                                                                              |
| MIN_RELEASE_NUMBER                               | String               | 0                                             | Sets the minimum Gateway release version to check while doing a gateway version assessment                                                                           |
| AR_IO_NODE_RELEASE                               | String               | 0                                             | Sets the current ar.io node version to be set on X-AR-IO-Node-Release header on requests to the reference gateway                                                    |
| OBSERVER_WALLET                                  | String               | "<example>"                                   | The public wallet address of the wallet being used to sign report upload transactions and contract interactions for Observer                                         |
| CHUNKS_DATA_PATH                                 | String               | "./data/chunks"                               | Sets the location for chunked data to be saved. If omitted, chunked data will be stored in the `data` directory                                                      |
| CONTIGUOUS_DATA_PATH                             | String               | "./data/contiguous"                           | Sets the location for contiguous data to be saved. If omitted, contiguous data will be stored in the `data` directory                                                |
| HEADERS_DATA_PATH                                | String               | "./data/headers"                              | Sets the location for header data to be saved. If omitted, header data will be stored in the `data` directory                                                        |
| SQLITE_DATA_PATH                                 | String               | "./data/sqlite"                               | Sets the location for sqlite indexed data to be saved. If omitted, sqlite data will be stored in the `data` directory                                                |
| DUCKDB_DATA_PATH                                 | String               | "./data/duckdb"                               | Sets the location for duckdb data to be saved. If omitted, duckdb data will be stored in the `data` directory                                                        |
| TEMP_DATA_PATH                                   | String               | "./data/tmp"                                  | Sets the location for temporary data to be saved. If omitted, temporary data will be stored in the `data` directory                                                  |
| OBSERVER_STATE_PATH                              | String               | "./data/observer"                             | Sets the location for Observer state data to be saved. Used to persist continuous observation state across restarts                                                  |
| LMDB_DATA_PATH                                   | String               | "./data/LMDB"                                 | Sets the location for LMDB data to be saved. If omitted, LMDB data will be stored in the `data` directory                                                            |
| SECRETS_PATH                                     | String               | "./secrets"                                   | Sets the location for sensitive configuration files (e.g., CDP API keys). Mounted read-only in container for security                                               |
| CHAIN_CACHE_TYPE                                 | String               | "redis"                                       | Sets the method for caching chain data, defaults redis if gateway is started with docker-compose, otherwise defaults to LMDB                                         |
| REDIS_CACHE_URL                                  | String (URL)         | "redis://localhost:6379"                      | URL of Redis database to be used for caching                                                                                                                         |
| REDIS_CACHE_TTL_SECONDS                          | Number               | 28800                                         | TTL value for Redis cache, defaults to 8 hours (28800 seconds)                                                                                                       |
| ENABLE_FS_HEADER_CACHE_CLEANUP                   | Boolean              | true if starting with docker, otherwise false | If true, periodically deletes cached header data                                                                                                                     |
| ENABLE_CHUNK_SYMLINK_CLEANUP                     | Boolean              | true                                          | If true, periodically removes dead symlinks from chunk cache directories (symlinks pointing to expired cached data)                                                  |
| CHUNK_SYMLINK_CLEANUP_INTERVAL                   | Number               | 86400                                         | Interval in seconds between dead symlink cleanup runs (default: 24 hours)                                                                                            |
| NODE_JS_MAX_OLD_SPACE_SIZE                       | Number               | 2048 or 8192, depending on number of workers  | Sets the memory limit, in Megabytes, for NodeJs. Default value is 2048 if using less than 2 unbundle workers, otherwise 8192                                         |
| SUBMIT_CONTRACT_INTERACTIONS                     | Boolean              | true                                          | If true, Observer will submit its generated reports to the ar.io Network                                                                                             |
| REDIS_MAX_MEMORY                                 | String               | 256mb                                         | Sets the max memory allocated to Redis                                                                                                                               |
| REDIS_DATA_PATH                                  | String               | "./data/redis"                                | Sets the location for Redis data persistence files (dump.rdb, appendonly.aof). Only used if persistence is enabled via EXTRA_REDIS_FLAGS                            |
| EXTRA_REDIS_FLAGS                                | String               | --save "" --appendonly no                     | Additional CLI flags passed to Redis server. Default disables persistence for performance. Set to "--save 300 10 --appendonly yes --appendfsync everysec" to enable hybrid persistence (recommended for x402 paid tokens) |
| LEGACY_AWS_S3_CHUNK_DATA_BUCKET                  | String               | undefined                                     | S3 bucket name for legacy chunk data source. Required when 'legacy-s3' is in CHUNK_DATA_RETRIEVAL_ORDER                                                              |
| LEGACY_AWS_S3_CHUNK_DATA_PREFIX                  | String               | undefined                                     | Optional prefix for chunk data in the legacy S3 bucket. If omitted, the root of the bucket will be /{dataRoot}/{relativeOffset}                                      |
| LEGACY_AWS_S3_ACCESS_KEY_ID                      | String               | undefined                                     | AWS access key for legacy S3 chunk bucket (optional - falls back to AWS_ACCESS_KEY_ID if not set)                                                                    |
| LEGACY_AWS_S3_SECRET_ACCESS_KEY                  | String               | undefined                                     | AWS secret key for legacy S3 chunk bucket (optional - falls back to AWS_SECRET_ACCESS_KEY if not set)                                                                |
| LEGACY_AWS_S3_REGION                             | String               | undefined                                     | AWS region for legacy S3 chunk bucket. Required if using separate credentials (LEGACY_AWS_S3_ACCESS_KEY_ID)                                                          |
| LEGACY_AWS_S3_ENDPOINT                           | String               | undefined                                     | Custom endpoint for legacy S3 chunk bucket (optional - for S3-compatible services)                                                                                   |
| LEGACY_PSQL_CONNECTION_STRING                    | String               | undefined                                     | PostgreSQL connection URL for legacy chunk metadata source (format: postgresql://user:pass@host:port/database). Required when 'legacy-psql' is in CHUNK_METADATA_RETRIEVAL_ORDER |
| LEGACY_PSQL_PASSWORD_FILE                        | String               | undefined                                     | File path containing PostgreSQL password (alternative to including password in connection string for better security)                                                |
| LEGACY_PSQL_SSL_REJECT_UNAUTHORIZED              | Boolean              | true                                          | If false, allows connections to PostgreSQL servers with self-signed certificates (common workaround for cloud providers)                                            |
| LEGACY_PSQL_MAX_CONNECTIONS                      | Number               | 10                                            | Maximum number of connections in the PostgreSQL connection pool                                                                                                      |
| LEGACY_PSQL_IDLE_TIMEOUT_SECONDS                 | Number               | 30                                            | Time in seconds before idle connections are closed in the pool                                                                                                       |
| LEGACY_PSQL_CONNECT_TIMEOUT_SECONDS              | Number               | 10                                            | Maximum time in seconds to wait when establishing a new connection                                                                                                   |
| LEGACY_PSQL_MAX_LIFETIME_SECONDS                 | Number               | 1800                                          | Maximum lifetime in seconds for a connection before it's rotated (30 minutes default)                                                                                |
| LEGACY_PSQL_STATEMENT_TIMEOUT_MS                 | Number               | 5000                                          | Server-side query timeout in milliseconds. Prevents queries from running forever. Critical for preventing system hangs                                               |
| LEGACY_PSQL_IDLE_IN_TRANSACTION_TIMEOUT_MS       | Number               | 10000                                         | Server-side timeout in milliseconds for idle transactions. Cleans up stuck transactions that hold locks                                                              |
| WEBHOOK_TARGET_SERVERS                           | String               | undefined                                     | Target servers for webhooks                                                                                                                                          |
| WEBHOOK_INDEX_FILTER                             | String               | {"never": true}                               | Only emit webhooks for transactions and data items compliant with this filter                                                                                        |
| WEBHOOK_BLOCK_FILTER                             | String               | {"never": true}                               | Only emit webhooks for blocks compliant with this filter                                                                                                             |
| CONTIGUOUS_DATA_CACHE_CLEANUP_THRESHOLD          | Number               | undefined                                     | Sets the age threshold in seconds; files older than this are candidates for contiguous data cache cleanup                                                            |
| ENABLE_MEMPOOL_WATCHER                           | Boolean              | false                                         | If true, the observer will start indexing pending tx from the mempool                                                                                                |
| MEMPOOL_POLLING_INTERVAL_MS                      | Number               | 30000                                         | Sets the mempool polling interval in milliseconds                                                                                                                    |
| TAG_SELECTIVITY                                  | String               | Refer to config.ts                            | A JSON map of tag names to selectivity weights used to order SQLite tag joins                                                                                        |
| MAX_EXPECTED_DATA_ITEM_INDEXING_INTERVAL_SECONDS | Number               | undefined                                     | Sets the max expected data item indexing interval in seconds                                                                                                         |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_NAME               | String               | ""                                            | S3-compatible bucket name, used by the Litestream backup service                                                                                                     |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_REGION             | String               | ""                                            | S3-compatible bucket region, used by the Litestream backup service                                                                                                   |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_ACCESS_KEY         | String               | ""                                            | S3-compatible bucket access_key credential, used by Litestream backup service, omit if using resource-based IAM role                                                 |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_SECRET_KEY         | String               | ""                                            | S3-compatible bucket access_secret_key credential, used by Litestream backup service, omit if using resource-based IAM role                                          |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_PREFIX             | String               | ""                                            | A prepended prefix for the S3 bucket where SQLite backups are stored.                                                                                                |
| ARNS_MAX_CONCURRENT_RESOLUTIONS                  | Number               | Number of ArNS resolvers                      | Maximum number of concurrent resolutions allowed for ARNs.                                                                                                           |
| AWS_ACCESS_KEY_ID                                | String               | undefined                                     | AWS access key ID for accessing AWS services                                                                                                                         |
| AWS_SECRET_ACCESS_KEY                            | String               | undefined                                     | AWS secret access key for accessing AWS services                                                                                                                     |
| AWS_REGION                                       | String               | undefined                                     | AWS region where the resources are located                                                                                                                           |
| AWS_ENDPOINT                                     | String               | undefined                                     | Custom endpoint for AWS services                                                                                                                                     |
| AWS_S3_CONTIGUOUS_DATA_BUCKET                    | String               | undefined                                     | AWS S3 bucket name used for storing data                                                                                                                             |
| AWS_S3_CONTIGUOUS_DATA_PREFIX                    | String               | undefined                                     | Prefix for the S3 bucket to organize data                                                                                                                            |
| CHUNK_POST_MIN_SUCCESS_COUNT                     | String               | "3"                                           | Minimum count of 200 responses for of a given chunk to be considered properly seeded                                                                                 |
| CHUNK_POST_MAX_CONSECUTIVE_FAILURES              | String               | "5"                                           | Maximum consecutive 4xx responses before stopping chunk broadcast. Only applies when no peers have accepted the chunk. Set to 0 to disable early termination        |
| ARWEAVE_POST_DRY_RUN                             | Boolean              | false                                         | If true, simulates transaction header and chunk submission without posting to Arweave. Returns 200 OK to clients. Works on both port 3000 (Envoy) and port 4000     |
| CHUNK_GET_BASE64_SIZE_BYTES                      | Number               | 368640                                        | Assumed size in bytes for base64-encoded chunk responses, used for x402 payment and rate limiting calculations (default: 360 KiB)                                    |
| CHUNK_REBROADCAST_SOURCES                        | String               | ""                                            | Comma-separated list of sources that trigger chunk rebroadcasting. Valid: `legacy-s3`, `ar-io-network`, `arweave-network`. Empty disables rebroadcasting             |
| CHUNK_REBROADCAST_RATE_LIMIT_TOKENS              | Number               | 60                                            | Rate limit tokens per interval for chunk rebroadcasting                                                                                                              |
| CHUNK_REBROADCAST_RATE_LIMIT_INTERVAL            | String               | "minute"                                      | Rate limit interval for chunk rebroadcasting: `second`, `minute`, `hour`, `day`                                                                                      |
| CHUNK_REBROADCAST_MAX_CONCURRENT                 | Number               | 5                                             | Maximum concurrent chunk rebroadcast operations                                                                                                                      |
| CHUNK_REBROADCAST_DEDUP_TTL_SECONDS              | Number               | 3600                                          | Deduplication cache TTL in seconds (don't rebroadcast same chunk within this period)                                                                                 |
| CHUNK_REBROADCAST_MIN_SUCCESS_COUNT              | Number               | 1                                             | Minimum broadcast success count for chunk to be added to dedup cache                                                                                                 |
| BUNDLE_REPAIR_RETRY_INTERVAL_SECONDS             | String               | "300"                                         | Interval in seconds for retrying bundles                                                                                                                             |
| BUNDLE_REPAIR_RETRY_BATCH_SIZE                   | String               | "1000"                                        | Batch size for retrying bundles                                                                                                                                      |
| APEX_TX_ID                                       | String               | undefined                                     | If set, serves this transaction ID's data at the root path (/)                                                                                                       |
| APEX_ARNS_NAME                                   | String               | undefined                                     | If set, resolves and serves this ArNS name's content at the root path (/)                                                                                            |
| ENABLE_RATE_LIMITER                              | Boolean              | false                                         | If true, enables rate limiting enforcement (returns 429 when limits exceeded). When false, limits are tracked but not enforced                                       |
| RATE_LIMITER_TYPE                                | String               | "redis" (docker), "memory" (standalone)       | Sets the rate limiter implementation type. Use "memory" for local development/single-node, "redis" for production multi-node deployments                              |
| RATE_LIMITER_REDIS_ENDPOINT                      | String               | "redis://redis:6379"                          | Redis endpoint URL for rate limiter (only used when RATE_LIMITER_TYPE is "redis")                                                                                    |
| RATE_LIMITER_REDIS_USE_TLS                       | Boolean              | false                                         | Whether to use TLS when connecting to Redis for rate limiting                                                                                                        |
| RATE_LIMITER_REDIS_USE_CLUSTER                   | Boolean              | false                                         | Whether to use Redis cluster mode for rate limiting                                                                                                                  |
| RATE_LIMITER_RESOURCE_TOKENS_PER_BUCKET          | Number               | 1000000                                       | Maximum tokens in the resource bucket (1 token = 1 KiB, where 1 KiB = 1,024 bytes). Default allows ~1 GiB per resource                                              |
| RATE_LIMITER_RESOURCE_REFILL_PER_SEC             | Number               | 100                                           | Tokens to refill per second for resource bucket. Default allows ~100 KiB/s sustained throughput per resource                                                         |
| RATE_LIMITER_IP_TOKENS_PER_BUCKET                | Number               | 100000                                        | Maximum tokens in the IP bucket (1 token = 1 KiB, where 1 KiB = 1,024 bytes). Default allows ~100 MiB per IP                                                        |
| RATE_LIMITER_IP_REFILL_PER_SEC                   | Number               | 20                                            | Tokens to refill per second for IP bucket. Default allows ~20 KiB/s sustained throughput per IP                                                                      |
| RATE_LIMITER_IPS_AND_CIDRS_ALLOWLIST             | String               | ""                                            | Comma-separated list of IPs and CIDR ranges to exempt from rate limiting (e.g., "192.168.1.0/24,10.0.0.1")                                                          |
| RATE_LIMITER_ARNS_ALLOWLIST                      | String               | ""                                            | Comma-separated list of ArNS names to exempt from rate limiting and payment verification (e.g., "my-free-app,public-docs")                                          |
| CACHE_PRIVATE_SIZE_THRESHOLD                     | Number               | 104857600 (100 MB)                            | Response size threshold in bytes above which Cache-Control uses 'private' directive. Helps CDNs respect rate limiting and x402 payment requirements for large responses |
| CACHE_PRIVATE_CONTENT_TYPES                      | String               | ""                                            | Comma-separated list of content types that should use 'private' Cache-Control directive. Supports wildcards (e.g., "image/*,video/*"). Helps CDNs respect rate limiting and x402 payments for specific content types |
| ENABLE_X_402_USDC_DATA_EGRESS                    | Boolean              | false                                         | If true, enables x402 USDC payment verification and settlement for data egress                                                                                       |
| X_402_USDC_NETWORK                               | String               | "base-sepolia"                                | USDC network to use ("base" for mainnet, "base-sepolia" for testnet)                                                                                                 |
| X_402_USDC_WALLET_ADDRESS                        | String               | undefined                                     | Ethereum wallet address (0x...) to receive USDC payments                                                                                                             |
| X_402_USDC_FACILITATOR_URL                       | String               | "https://x402.org/facilitator"                | x402 facilitator endpoint URL. Default is Coinbase's testnet facilitator. **Note**: When CDP API keys are provided (CDP_API_KEY_ID and CDP_API_KEY_SECRET), the Coinbase facilitator is automatically used, overriding this setting |
| X_402_USDC_DATA_EGRESS_MIN_PRICE                 | Number               | 0.001                                         | Minimum price in USDC for data egress (used when content length is unknown)                                                                                          |
| X_402_USDC_DATA_EGRESS_MAX_PRICE                 | Number               | 1.00                                          | Maximum price in USDC for data egress (caps per-request cost)                                                                                                        |
| X_402_USDC_PER_BYTE_PRICE                        | Number               | 0.0000000001                                  | Price in USDC per byte of data egress (default: $0.10 per GB)                                                                                                        |
| X_402_RATE_LIMIT_CAPACITY_MULTIPLIER             | Number               | 10                                            | Capacity multiplier for paid tier rate limits (e.g., 10x = paid users get 10x bucket capacity)                                                                       |
| X_402_USDC_SETTLE_TIMEOUT_MS                     | Number               | 5000                                          | Timeout in milliseconds for payment settlement operations                                                                                                            |
| X_402_CDP_CLIENT_KEY                             | String               | undefined                                     | Coinbase Developer Platform client API key (public, safe to expose in browser paywall)                                                                               |
| X_402_APP_NAME                                   | String               | "AR.IO Gateway"                               | Application name displayed in payment UI                                                                                                                             |
| X_402_APP_LOGO                                   | String               | undefined                                     | URL to application logo displayed in payment UI                                                                                                                      |
| X_402_SESSION_TOKEN_ENDPOINT                     | String               | undefined                                     | Custom session token endpoint URL for payment authentication                                                                                                         |
| CDP_API_KEY_ID                                   | String               | undefined                                     | **SENSITIVE SECRET**: Coinbase Developer Platform secret API key ID (for Onramp session token generation and Coinbase facilitator integration). When provided with CDP_API_KEY_SECRET, automatically enables Coinbase facilitator. Must not be logged or exposed. Store in secure secrets manager and restrict access (least privilege). |
| CDP_API_KEY_SECRET                               | String               | undefined                                     | **SENSITIVE SECRET**: Coinbase Developer Platform secret API key secret (for Onramp session token generation and Coinbase facilitator integration). When provided with CDP_API_KEY_ID, automatically enables Coinbase facilitator. Must not be logged or exposed. Store in secure secrets manager and restrict access (least privilege). |
| CDP_API_KEY_SECRET_FILE                          | String               | undefined                                     | **SENSITIVE SECRET**: File path containing CDP secret API key secret. Takes precedence over CDP_API_KEY_SECRET if defined. Must not be logged or exposed.            |
| OTEL_SERVICE_NAME                                | String               | "ar-io-node"                                  | Service name for OpenTelemetry traces. Used to identify this service in telemetry backends                                                                          |
| OTEL_TRACING_SAMPLING_RATE_DENOMINATOR           | Number               | 1                                             | Head-based sampling rate denominator (1/N spans sampled). Note: In docker-compose, tail sampling via OTEL Collector is used instead for intelligent sampling      |
| OTEL_EXPORTER_OTLP_ENDPOINT                      | String               | "http://otel-collector:4318" (docker)         | OTLP endpoint for traces/logs. In docker-compose, defaults to collector for tail sampling. For non-docker deployments, set to your telemetry backend URL           |
| OTEL_EXPORTER_OTLP_HEADERS                       | String               | undefined                                     | Authentication headers for OTLP exporter (e.g., "x-honeycomb-team=your-api-key"). For non-docker deployments only. Use OTEL_COLLECTOR_DESTINATION_HEADERS in docker |
| OTEL_EXPORTER_OTLP_HEADERS_FILE                  | String               | undefined                                     | File path containing OTLP exporter headers. For non-docker deployments only. Use OTEL_COLLECTOR_DESTINATION_HEADERS_FILE in docker                                  |
| OTEL_FILE_EXPORT_ENABLED                         | Boolean              | false (true with yarn service:start)          | Enable file-based export of OTEL spans for development/debugging. Spans written to OTEL_FILE_EXPORT_PATH                                                           |
| OTEL_FILE_EXPORT_PATH                            | String               | "logs/otel-spans.jsonl"                       | Path for file-based OTEL span export (JSONL format). Only used when OTEL_FILE_EXPORT_ENABLED is true                                                               |
| OTEL_BATCH_LOG_PROCESSOR_SCHEDULED_DELAY_MS      | Number               | 2000                                          | Delay in milliseconds before batch log export                                                                                                                       |
| OTEL_BATCH_LOG_PROCESSOR_MAX_EXPORT_BATCH_SIZE   | Number               | 10000                                         | Maximum number of log records to export in a single batch                                                                                                           |
| OTEL_COLLECTOR_IMAGE_TAG                         | String               | "0.119.0"                                     | Docker image tag for OpenTelemetry Collector. Only applies to docker-compose deployments                                                                           |
| OTEL_COLLECTOR_DESTINATION_ENDPOINT              | String               | undefined                                     | Final telemetry destination URL where OTEL Collector forwards sampled traces. Examples: Honeycomb (https://api.honeycomb.io), Grafana Cloud, Datadog, New Relic, Elastic APM |
| OTEL_COLLECTOR_HONEYCOMB_API_KEY                 | String               | undefined                                     | Honeycomb API key for authentication (x-honeycomb-team header). Configure ONE backend API key                                                                      |
| OTEL_COLLECTOR_GRAFANA_CLOUD_API_KEY             | String               | undefined                                     | Grafana Cloud API key for authentication (Authorization: Basic header). Base64 encoded instance_id:api_key. Configure ONE backend API key                          |
| OTEL_COLLECTOR_DATADOG_API_KEY                   | String               | undefined                                     | Datadog API key for authentication (DD-API-KEY header). Configure ONE backend API key                                                                               |
| OTEL_COLLECTOR_NEW_RELIC_API_KEY                 | String               | undefined                                     | New Relic license key for authentication (api-key header). Configure ONE backend API key                                                                            |
| OTEL_COLLECTOR_ELASTIC_API_KEY                   | String               | undefined                                     | Elastic APM secret token for authentication (Authorization: Bearer header). Configure ONE backend API key                                                           |
| OTEL_TAIL_SAMPLING_SUCCESS_RATE                  | Number               | 1                                             | Percentage (1-100) of successful/fast/unpaid traces to sample. Default: 1% provides baseline metrics with 80-95% cost reduction                                    |
| OTEL_TAIL_SAMPLING_SLOW_THRESHOLD_MS             | Number               | 2000                                          | Latency threshold in milliseconds. Requests exceeding this duration are eligible for sampling (rate controlled by OTEL_TAIL_SAMPLING_SLOW_RATE)                    |
| OTEL_TAIL_SAMPLING_ERROR_RATE                    | Number               | 100                                           | Percentage (1-100) of error traces (5xx status codes) to sample. Default: 100% captures all errors for debugging. Lower values reduce costs but may miss issues   |
| OTEL_TAIL_SAMPLING_SLOW_RATE                     | Number               | 100                                           | Percentage (1-100) of slow request traces (exceeding OTEL_TAIL_SAMPLING_SLOW_THRESHOLD_MS) to sample. Default: 100% captures all slow requests for performance analysis |
| OTEL_TAIL_SAMPLING_PAID_TRAFFIC_RATE             | Number               | 100                                           | Percentage (1-100) of paid traffic traces (x402 verified payments) to sample. Default: 100% for billing/compliance. Reduce only if paid traffic is high volume     |
| OTEL_TAIL_SAMPLING_PAID_TOKENS_RATE              | Number               | 100                                           | Percentage (1-100) of paid rate limit token usage traces to sample. Default: 100% for billing/compliance. Reduce only if paid token usage is high volume           |
| OTEL_TAIL_SAMPLING_NESTED_BUNDLE_RATE            | Number               | 5                                             | Percentage (1-100) of nested bundle data item retrieval traces to sample. Captures TurboDynamoDB requests involving parent offsets for visibility into nested bundle paths |
| OTEL_TAIL_SAMPLING_OFFSET_OVERWRITE_RATE         | Number               | 10                                            | Percentage (1-100) of offset overwrite risk traces to sample. Captures traces where both DynamoDB offsets AND raw data paths executed, the scenario that triggered the Release 59 offset bug |

**Security Note:** Variables marked as **SENSITIVE SECRET** (such as `CDP_API_KEY_ID`, `CDP_API_KEY_SECRET`, and `CDP_API_KEY_SECRET_FILE`) contain confidential credentials that must never be printed to logs, exposed in error messages, or included in any diagnostic output. Always mask or omit these values in logs, store them in a secure secrets manager, and restrict access using the principle of least privilege.

## Observer Configuration

The following environment variables configure the Observer service for network gateway observations.

### Reference Gateway Configuration

These settings control which gateways are used as references for ArNS resolution and chunk verification checks.

| ENV_NAME                                         | TYPE                 | DEFAULT_VALUE                                 | DESCRIPTION                                                                                                                                                          |
| ------------------------------------------------ | -------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| REFERENCE_GATEWAY_HOSTS                          | String               | "turbo-gateway.com,ar-io.net"                 | Comma-separated list of reference gateway hosts for ArNS and chunk checks. These gateways are tried in order before network fallback                                |
| REFERENCE_GATEWAY_NETWORK_ONLY                   | Boolean              | false                                         | If true, uses only network gateways for reference checks (no explicit hosts). Enables fully decentralized observation                                               |
| REFERENCE_GATEWAY_NETWORK_FALLBACK               | Boolean              | true                                          | If true, falls back to network consensus when explicit reference hosts fail or disagree                                                                             |
| REFERENCE_GATEWAY_CONSENSUS_SIZE                 | Number               | 3                                             | Number of network gateways to query when building consensus for ArNS resolution                                                                                     |
| REFERENCE_GATEWAY_CONSENSUS_THRESHOLD            | Number               | 2                                             | Minimum number of agreeing gateways required to establish consensus                                                                                                 |
| REFERENCE_GATEWAY_MIN_PASS_RATE                  | Number               | 0.8                                           | Minimum historical pass rate (0.0-1.0) for a network gateway to be eligible for consensus queries                                                                   |
| REFERENCE_GATEWAY_MIN_CONSECUTIVE_PASSES         | Number               | 2                                             | Minimum consecutive passing epochs required for network gateway eligibility                                                                                         |
| REFERENCE_GATEWAY_MIN_EPOCH_COUNT                | Number               | 5                                             | Minimum total epochs observed for a network gateway to be considered for eligibility                                                                                |
| REFERENCE_GATEWAY_MAX_NETWORK_POOL               | Number               | 10                                            | Maximum number of eligible network gateways to keep in the pool for random selection                                                                                |
| REFERENCE_GATEWAY_NETWORK_CACHE_TTL_SECONDS      | Number               | 300                                           | TTL in seconds for caching the list of eligible network gateways from the AR.IO contract                                                                            |
| REFERENCE_GATEWAY_CONSENSUS_MAX_ATTEMPTS         | Number               | 5                                             | Maximum number of gateway queries to attempt when trying to reach consensus threshold                                                                               |

### Continuous Observation Configuration

These settings control the continuous observation mode, which spreads observations across the epoch window and uses majority voting for pass/fail determination.

| ENV_NAME                                         | TYPE                 | DEFAULT_VALUE                                 | DESCRIPTION                                                                                                                                                          |
| ------------------------------------------------ | -------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| OBSERVATIONS_PER_GATEWAY                         | Number               | 3                                             | Number of times each gateway is observed during an epoch. Results are aggregated using majority voting                                                              |
| OBSERVATION_WINDOW_FRACTION                      | Number               | 0.5                                           | Fraction of the epoch window (0.1-0.9) during which observations are spread. Higher values spread observations over more time                                       |
| OBSERVATION_CYCLE_INTERVAL_MS                    | Number               | 60000                                         | Interval in milliseconds between observation cycles. Each cycle processes scheduled observations                                                                    |
| MAJORITY_VOTE_THRESHOLD                          | Number               | 2                                             | Number of passing observations needed for a gateway to pass overall. Should be  OBSERVATIONS_PER_GATEWAY                                                           |

### Offset Observation Configuration

These settings control chunk offset verification observations, which validate that gateways correctly return chunk data with proper offset information.

| ENV_NAME                                         | TYPE                 | DEFAULT_VALUE                                 | DESCRIPTION                                                                                                                                                          |
| ------------------------------------------------ | -------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| OFFSET_OBSERVATION_SAMPLE_RATE                   | Number               | 0.10                                          | Sample rate (0.0-1.0) for offset observations. Higher values test more chunks but increase load on observed gateways                                                |
| OFFSET_OBSERVATION_ENABLED                       | Boolean              | true                                          | If true, enables offset observation checks. When false, offset observations are skipped entirely                                                                    |
| OFFSET_OBSERVATION_ENFORCEMENT_ENABLED           | Boolean              | false                                         | If true, offset observation failures affect gateway pass/fail status. When false, failures are logged but don't impact scoring                                      |
