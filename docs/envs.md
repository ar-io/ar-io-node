# ENVs

This document describes the environment variables that can be used to configure the `ar.io` node.

| ENV_NAME                                         | TYPE                 | DEFAULT_VALUE                                 | DESCRIPTION                                                                                                                                                          |
| ------------------------------------------------ | -------------------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| START_HEIGHT                                     | Number or "Infinity" | 0                                             | Starting block height for node synchronization (0 = start from the beginning)                                                                                        |
| STOP_HEIGHT                                      | Number or "Infinity" | "Infinity"                                    | Stop block height for node synchronization (Infinity = keep syncing until stopped)                                                                                   |
| TRUSTED_NODE_URL                                 | String               | "https://arweave.net"                         | Arweave node to use for fetching data                                                                                                                                |
| TRUSTED_NODE_HOST                                | String               | "arweave.net"                                 | Hostname for the trusted Arweave node used by Envoy proxy                                                                                                            |
| TRUSTED_NODE_PORT                                | Number               | 443                                           | Port for the trusted Arweave node used by Envoy proxy                                                                                                                |
| TRUSTED_GATEWAY_URL                              | String               | "https://arweave.net"                         | Arweave node to use for proxying requests                                                                                                                            |
| TRUSTED_GATEWAYS_URLS                            | String               | TRUSTED_GATEWAY_URL                           | A JSON map of gateways and priority                                                                                                                                  |
| TRUSTED_GATEWAYS_REQUEST_TIMEOUT_MS              | String               | "10000"                                       | Request timeout in milliseconds for trusted gateways                                                                                                                 |
| TRUSTED_GATEWAYS_BLOCKED_ORIGINS                 | String               | ""                                            | Comma-separated list of X-AR-IO-Origin header values to block when forwarding to trusted gateways (prevents loops and blocks unwanted sources)                   |
| TRUSTED_GATEWAYS_BLOCKED_IPS_AND_CIDRS           | String               | ""                                            | Comma-separated list of IPs and CIDR ranges to block when forwarding to trusted gateways (prevents forwarding requests from specific client IPs)                |
| TRUSTED_ARNS_GATEWAY_URL                         | String               | "https://__NAME__.arweave.dev"                | ArNS gateway                                                                                                                                                         |
| TURBO_ENDPOINT                                   | String               | "https://turbo.arweave.dev"                   | Turbo endpoint URL for root transaction ID lookups                                                                                                                   |
| TURBO_REQUEST_TIMEOUT_MS                         | Number               | 10000                                         | Request timeout in milliseconds for Turbo requests                                                                                                                   |
| TURBO_REQUEST_RETRY_COUNT                        | Number               | 3                                             | Number of retries for Turbo requests                                                                                                                                 |
| ROOT_TX_CACHE_MAX_SIZE                           | Number               | 100000                                        | Maximum size of the root transaction ID cache                                                                                                                        |
| ROOT_TX_CACHE_TTL_MS                             | Number               | 300000                                        | TTL in milliseconds for root transaction ID cache entries (5 minutes)                                                                                                |
| ROOT_TX_INDEX_CIRCUIT_BREAKER_TIMEOUT_MS         | Number               | 30000                                         | Circuit breaker timeout in milliseconds for root transaction index requests                                                                                          |
| ROOT_TX_INDEX_CIRCUIT_BREAKER_FAILURE_THRESHOLD  | Number               | 50                                            | Circuit breaker failure threshold percentage for root transaction index requests                                                                                     |
| ROOT_TX_INDEX_CIRCUIT_BREAKER_SUCCESS_THRESHOLD  | Number               | 2                                             | Number of successful requests needed to close circuit breaker for root transaction index                                                                             |
| WEIGHTED_PEERS_TEMPERATURE_DELTA                 | Number               | 0.1                                           | Any positive number above 0, best to keep 1 or less. Used to determine the sensivity of which the probability of failing or succeeding peers decreases or increases. |
| INSTANCE_ID                                      | String               | ""                                            | Adds an "INSTANCE_ID" field to output logs                                                                                                                           |
| LOG_FORMAT                                       | String               | "simple"                                      | Sets the format of output logs, accepts "simple" and "json"                                                                                                          |
| SKIP_CACHE                                       | Boolean              | false                                         | If true, skips the local cache and always fetches headers from the node                                                                                              |
| SKIP_DATA_CACHE                                  | Boolean              | false                                         | If true, skips the data cache (read-through data cache) and always fetches data from upstream sources                                                               |
| PORT                                             | Number               | 4000                                          | ar.io node exposed port number                                                                                                                                       |
| SIMULATED_REQUEST_FAILURE_RATE                   | Number               | 0                                             | Number from 0 to 1, representing the probability of a request failing                                                                                                |
| AR_IO_WALLET                                     | String               | ""                                            | Arweave wallet address used for staking and rewards                                                                                                                  |
| ADMIN_API_KEY                                    | String               | Generated                                     | API key used for admin API requests (if not set, it's generated and logged into the console)                                                                         |
| ADMIN_API_KEY_FILE                               | String               | Generated                                     | Alternative way to set the API key used for admin API requests via filepath, it takes precedene over ADMIN_API_KEY if defined                                        |
| BACKFILL_BUNDLE_RECORDS                          | Boolean              | false                                         | If true, ar.io node will start indexing missing bundles                                                                                                              |
| FILTER_CHANGE_REPROCESS                          | Boolean              | false                                         | If true, all indexed bundles will be reprocessed with the new filters (you can use this when you change the filters)                                                 |
| ON_DEMAND_RETRIEVAL_ORDER                        | String               | trusted-gateways,ar-io-network,chunks-offset-aware,tx-data | Data source retrieval order for on-demand data requests. Note: 'chunks-data-item' is deprecated, use 'chunks-offset-aware' instead                                   |
| BACKGROUND_RETRIEVAL_ORDER                       | String               | chunks                                         | Data source retrieval order for background data requests (i.e., unbundling)                                                                                          |
| ANS104_UNBUNDLE_FILTER                           | String               | {"never": true}                               | Only bundles compliant with this filter will be unbundled                                                                                                            |
| ANS104_INDEX_FILTER                              | String               | {"never": true}                               | Only bundles compliant with this filter will be indexed                                                                                                              |
| ANS104_DOWNLOAD_WORKERS                          | String               | 5                                             | Sets the number of ANS-104 bundles to attempt to download in parallel                                                                                                |
| ANS104_UNBUNDLE_WORKERS                          | Number               | 0, or 1 if filters are set                    | Sets the number of workers used to handle unbundling                                                                                                                 |
| DATA_ITEM_FLUSH_COUNT_THRESHOLD                  | Number               | 1000                                          | Sets the number of new data items indexed before flushing to to stable data items                                                                                    |
| MAX_FLUSH_INTERVAL_SECONDS                       | Number               | 600                                           | Sets the maximum time interval in seconds before flushing to stable data items                                                                                       |
| WRITE_ANS104_DATA_ITEM_DB_SIGNATURES             | Boolean              | false                                         | If true, the data item signatures will be written to the database.                                                                                                   |
| WRITE_TRANSACTION_DB_SIGNATURES                  | Boolean              | true                                          | If true, the transactions signatures will be written to the database.                                                                                                |
| ENABLE_DATA_DB_WAL_CLEANUP                       | Boolean              | false                                         | If true, the data database WAL cleanup worker will be enabled                                                                                                        |
| ENABLE_BACKGROUND_DATA_VERIFICATION              | Boolean              | false                                         | If true, unverified data will be verified in background                                                                                                              |
| MAX_DATA_ITEM_QUEUE_SIZE                         | Number               | 100000                                        | Sets the maximum number of data items to queue for indexing before skipping indexing new data items                                                                  |
| ARNS_ROOT_HOST                                   | String               | undefined                                     | Domain name for ArNS host                                                                                                                                            |
| SANDBOX_PROTOCOL                                 | String               | undefined                                     | Protocol setting in process of creating sandbox domain in ArNS (ARNS_ROOT_HOST needs to be set for this env to have any effect)                                      |
| START_WRITERS                                    | Boolean              | true                                          | If true, start indexing blocks, tx, ANS104 bundles                                                                                                                   |
| RUN_OBSERVER                                     | Boolean              | true                                          | If true, runs the Observer alongside the gateway to generate Network compliance reports                                                                              |
| MIN_RELEASE_NUMBER                               | String               | 0                                             | Sets the minimum Gateway release version to check while doing a gateway version assessment                                                                           |
| AR_IO_NODE_RELEASE                               | String               | 0                                             | Sets the current ar.io node version to be set on X-AR-IO-Node-Release header on requests to the reference gateway                                                    |
| OBSERVER_WALLET                                  | String               | "<example>"                                   | The public wallet address of the wallet being used to sign report upload transactions and contract interactions for Observer                                         |
| CHUNKS_DATA_PATH                                 | String               | "./data/chunks"                               | Sets the location for chunked data to be saved. If omitted, chunked data will be stored in the `data` directory                                                      |
| CONTIGUOUS_DATA_PATH                             | String               | "./data/contiguous"                           | Sets the location for contiguous data to be saved. If omitted, contiguous data will be stored in the `data` directory                                                |
| HEADERS_DATA_PATH                                | String               | "./data/headers"                              | Sets the location for header data to be saved. If omitted, header data will be stored in the `data` directory                                                        |
| SQLITE_DATA_PATH                                 | String               | "./data/sqlite"                               | Sets the location for sqlite indexed data to be saved. If omitted, sqlite data will be stored in the `data` directory                                                |
| DUCKDB_DATA_PATH                                 | String               | "./data/duckdb"                               | Sets the location for duckdb data to be saved. If omitted, duckdb data will be stored in the `data` directory                                                        |
| TEMP_DATA_PATH                                   | String               | "./data/tmp"                                  | Sets the location for temporary data to be saved. If omitted, temporary data will be stored in the `data` directory                                                  |
| LMDB_DATA_PATH                                   | String               | "./data/LMDB"                                 | Sets the location for LMDB data to be saved. If omitted, LMDB data will be stored in the `data` directory                                                            |
| CHAIN_CACHE_TYPE                                 | String               | "redis"                                       | Sets the method for caching chain data, defaults redis if gateway is started with docker-compose, otherwise defaults to LMDB                                         |
| REDIS_CACHE_URL                                  | String (URL)         | "redis://localhost:6379"                      | URL of Redis database to be used for caching                                                                                                                         |
| REDIS_CACHE_TTL_SECONDS                          | Number               | 28800                                         | TTL value for Redis cache, defaults to 8 hours (28800 seconds)                                                                                                       |
| ENABLE_FS_HEADER_CACHE_CLEANUP                   | Boolean              | true if starting with docker, otherwise false | If true, periodically deletes cached header data                                                                                                                     |
| NODE_JS_MAX_OLD_SPACE_SIZE                       | Number               | 2048 or 8192, depending on number of workers  | Sets the memory limit, in Megabytes, for NodeJs. Default value is 2048 if using less than 2 unbundle workers, otherwise 8192                                         |
| SUBMIT_CONTRACT_INTERACTIONS                     | Boolean              | true                                          | If true, Observer will submit its generated reports to the ar.io Network                                                                                             |
| REDIS_MAX_MEMORY                                 | String               | 256mb                                         | Sets the max memory allocated to Redis                                                                                                                               |
| REDIS_EXTRA_FLAGS                                | String               | --save "" --appendonly no                     | Additional CLI flags passed to Redis                                                                                                                                 |
| WEBHOOK_TARGET_SERVERS                           | String               | undefined                                     | Target servers for webhooks                                                                                                                                          |
| WEBHOOK_INDEX_FILTER                             | String               | {"never": true}                               | Only emit webhooks for transactions and data items compliant with this filter                                                                                        |
| WEBHOOK_BLOCK_FILTER                             | String               | {"never": true}                               | Only emit webhooks for blocks compliant with this filter                                                                                                             |
| CONTIGUOUS_DATA_CACHE_CLEANUP_THRESHOLD          | Number               | undefined                                     | Sets the age threshold in seconds; files older than this are candidates for contiguous data cache cleanup                                                            |
| ENABLE_MEMPOOL_WATCHER                           | Boolean              | false                                         | If true, the observer will start indexing pending tx from the mempool                                                                                                |
| MEMPOOL_POLLING_INTERVAL_MS                      | Number               | 30000                                         | Sets the mempool polling interval in milliseconds                                                                                                                    |
| TAG_SELECTIVITY                                  | String               | Refer to config.ts                            | A JSON map of tag names to selectivity weights used to order SQLite tag joins                                                                                        |
| MAX_EXPECTED_DATA_ITEM_INDEXING_INTERVAL_SECONDS | Number               | undefined                                     | Sets the max expected data item indexing interval in seconds                                                                                                         |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_NAME               | String               | ""                                            | S3-compatible bucket name, used by the Litestream backup service                                                                                                     |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_REGION             | String               | ""                                            | S3-compatible bucket region, used by the Litestream backup service                                                                                                   |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_ACCESS_KEY         | String               | ""                                            | S3-compatible bucket access_key credential, used by Litestream backup service, omit if using resource-based IAM role                                                 |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_SECRET_KEY         | String               | ""                                            | S3-compatible bucket access_secret_key credential, used by Litestream backup service, omit if using resource-based IAM role                                          |
| AR_IO_SQLITE_BACKUP_S3_BUCKET_PREFIX             | String               | ""                                            | A prepended prefix for the S3 bucket where SQLite backups are stored.                                                                                                |
| ARNS_MAX_CONCURRENT_RESOLUTIONS                  | Number               | Number of ArNS resolvers                      | Maximum number of concurrent resolutions allowed for ARNs.                                                                                                           |
| AWS_ACCESS_KEY_ID                                | String               | undefined                                     | AWS access key ID for accessing AWS services                                                                                                                         |
| AWS_SECRET_ACCESS_KEY                            | String               | undefined                                     | AWS secret access key for accessing AWS services                                                                                                                     |
| AWS_REGION                                       | String               | undefined                                     | AWS region where the resources are located                                                                                                                           |
| AWS_ENDPOINT                                     | String               | undefined                                     | Custom endpoint for AWS services                                                                                                                                     |
| AWS_S3_CONTIGUOUS_DATA_BUCKET                    | String               | undefined                                     | AWS S3 bucket name used for storing data                                                                                                                             |
| AWS_S3_CONTIGUOUS_DATA_PREFIX                    | String               | undefined                                     | Prefix for the S3 bucket to organize data                                                                                                                            |
| CHUNK_POST_MIN_SUCCESS_COUNT                     | String               | "3"                                           | Minimum count of 200 responses for of a given chunk to be considered properly seeded                                                                                 |
| BUNDLE_REPAIR_RETRY_INTERVAL_SECONDS             | String               | "300"                                         | Interval in seconds for retrying bundles                                                                                                                             |
| BUNDLE_REPAIR_RETRY_BATCH_SIZE                   | String               | "1000"                                        | Batch size for retrying bundles                                                                                                                                      |
| APEX_TX_ID                                       | String               | undefined                                     | If set, serves this transaction ID's data at the root path (/)                                                                                                       |
| APEX_ARNS_NAME                                   | String               | undefined                                     | If set, resolves and serves this ArNS name's content at the root path (/)                                                                                            |
| ENABLE_RATE_LIMITER                              | Boolean              | false                                         | If true, enables rate limiting enforcement (returns 429 when limits exceeded). When false, limits are tracked but not enforced                                       |
| RATE_LIMITER_TYPE                                | String               | "redis" (docker), "memory" (standalone)       | Sets the rate limiter implementation type. Use "memory" for local development/single-node, "redis" for production multi-node deployments                              |
| RATE_LIMITER_REDIS_ENDPOINT                      | String               | "redis://redis:6379"                          | Redis endpoint URL for rate limiter (only used when RATE_LIMITER_TYPE is "redis")                                                                                    |
| RATE_LIMITER_REDIS_USE_TLS                       | Boolean              | false                                         | Whether to use TLS when connecting to Redis for rate limiting                                                                                                        |
| RATE_LIMITER_REDIS_USE_CLUSTER                   | Boolean              | false                                         | Whether to use Redis cluster mode for rate limiting                                                                                                                  |
| RATE_LIMITER_RESOURCE_TOKENS_PER_BUCKET          | Number               | 1000000                                       | Maximum tokens in the resource bucket (1 token = 1 KB). Default allows ~1GB per resource                                                                             |
| RATE_LIMITER_RESOURCE_REFILL_PER_SEC             | Number               | 100                                           | Tokens to refill per second for resource bucket. Default allows ~100KB/s sustained throughput per resource                                                           |
| RATE_LIMITER_IP_TOKENS_PER_BUCKET                | Number               | 100000                                        | Maximum tokens in the IP bucket (1 token = 1 KB). Default allows ~100MB per IP                                                                                       |
| RATE_LIMITER_IP_REFILL_PER_SEC                   | Number               | 20                                            | Tokens to refill per second for IP bucket. Default allows ~20KB/s sustained throughput per IP                                                                        |
| RATE_LIMITER_IPS_AND_CIDRS_ALLOWLIST             | String               | ""                                            | Comma-separated list of IPs and CIDR ranges to exempt from rate limiting (e.g., "192.168.1.0/24,10.0.0.1")                                                          |
| ENABLE_X_402_USDC_DATA_EGRESS                    | Boolean              | false                                         | If true, enables x402 USDC payment verification and settlement for data egress                                                                                       |
| X_402_USDC_NETWORK                               | String               | "base-sepolia"                                | USDC network to use ("base" for mainnet, "base-sepolia" for testnet)                                                                                                 |
| X_402_USDC_WALLET_ADDRESS                        | String               | undefined                                     | Ethereum wallet address (0x...) to receive USDC payments                                                                                                             |
| X_402_USDC_FACILITATOR_URL                       | String               | "https://x402.org/facilitator"                | x402 facilitator endpoint URL. Default is Coinbase's testnet facilitator                                                                                             |
| X_402_USDC_DATA_EGRESS_MIN_PRICE                 | Number               | 0.001                                         | Minimum price in USDC for data egress (used when content length is unknown)                                                                                          |
| X_402_USDC_DATA_EGRESS_MAX_PRICE                 | Number               | 1.00                                          | Maximum price in USDC for data egress (caps per-request cost)                                                                                                        |
| X_402_USDC_PER_BYTE_PRICE                        | Number               | 0.0000000001                                  | Price in USDC per byte of data egress (default: $0.10 per GB)                                                                                                        |
| X_402_RATE_LIMIT_CAPACITY_MULTIPLIER             | Number               | 10                                            | Capacity multiplier for paid tier rate limits (e.g., 10x = paid users get 10x bucket capacity)                                                                       |
| X_402_USDC_SETTLE_TIMEOUT_MS                     | Number               | 5000                                          | Timeout in milliseconds for payment settlement operations                                                                                                            |
| X_402_CDP_CLIENT_KEY                             | String               | undefined                                     | Coinbase Developer Platform API client key (required for mainnet, optional for testnet)                                                                              |
| X_402_APP_NAME                                   | String               | "AR.IO Gateway"                               | Application name displayed in payment UI                                                                                                                             |
| X_402_APP_LOGO                                   | String               | undefined                                     | URL to application logo displayed in payment UI                                                                                                                      |
| X_402_SESSION_TOKEN_ENDPOINT                     | String               | undefined                                     | Custom session token endpoint URL for payment authentication                                                                                                         |
